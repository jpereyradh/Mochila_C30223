(("undefined"!==typeof self?self:this).webpackJsonp=("undefined"!==typeof self?self:this).webpackJsonp||[]).push([[268],{1449:function(t,e,i){t.exports=i.p+"media/images/drag_and_drop_hexagon-2df7708da1f8b54d36b8b03ccb5b2a53.svg"},1450:function(t,e,i){t.exports=i.p+"media/images/drag_and_drop_hexagon_outline-73f9e6d4986d9c6d6c7905c6d7c3b2dd.svg"},1787:function(t,e,i){"use strict";i.r(e);var n,o=i(1),a=i(0),r=i(1449),s=i.n(r),d=i(1450),p=i.n(d),l=i(671),c=function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},g=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)};const h=Object(a.m)("composerModal"),y=Object(a.m)("composerModalAlert"),f=Object(a.m)("contentPicker"),u=Object(a.m)("dragAndDropEvents"),D=Object(a.m)("draft"),v=Object(a.m)("post"),A=Object(a.m)("map");let m=class extends a.j{constructor(){super(...arguments),this.dragAndDropHexagon=s.a,this.dragAndDropHexagonOutline=p.a}get backgroundClasses(){return this.isAnyDraftActive?["bg-transparent"]:["bg-grape-500","dark:bg-drag-overlay-dark","bg-opacity-50","dark:bg-opacity-35"]}get xMessageHexagon(){return!this.isAnyDraftActive}get isAnyComposerModalDocked(){return this.isAnyDraftActive&&this.composerModalShouldDock}get isMapHandlingDragEvent(){return this.isDraggingLocationPickerPinInMap||this.isDraggingPostsInMap}initFileDragEvent(){this.setDraggedDataType({newType:l.a.File});let t="";t=this.isAnyDraftActive?this.isAnyComposerModalDocked?this.__("Drop the file here to add it to this post"):this.__("Drop the file anywhere to add it to this post"):this.__("Drop files anywhere to create a new post"),this.setDropActionMessage({message:t})}initLinkDragEvent(){this.setDraggedDataType({newType:l.a.Link});let t="";t=this.isAnyDraftActive?this.isAnyComposerModalDocked?this.__("Drop the link here to add it to this post"):this.__("Drop the link anywhere to add to this post"):this.__("Drop links anywhere to create a new post"),this.setDropActionMessage({message:t})}initTextDragEvent(){this.setDraggedDataType({newType:l.a.Text});let t="";t=this.isAnyDraftActive?this.isAnyComposerModalDocked?this.__("Drop the text here to add it to this post"):this.__("Drop the text anywhere to add it to this post"):this.__("Drop text anywhere to create a new post"),this.setDropActionMessage({message:t})}setupDragEvent(t){if(!t.dataTransfer)return void this.stopHandlingDragEvent();const e=t.dataTransfer.types;this.resetAlert(),e.includes("Files")?this.initFileDragEvent():e.includes("text/uri-list")?this.initLinkDragEvent():e.includes("text/plain")?this.initTextDragEvent():this.stopHandlingDragEvent()}handleFileDrop({files:t,left:e,top:i,shouldAddToActiveDraft:n}){if(t&&0!==t.length)if(n){if(t.length>1)return void this.openAlert({title:this.__("Multiple files added"),body:this.__("While writing a post only one file can be added at a time"),primaryActionText:this.__("Okay"),primaryActions:[]});const e=t[0];if(this.activeDraft.attachment||this.activeDraftUploadingFile){const t=this.activeDraft.attachment?[{type:"draft/removeDraftAttachment",payload:{postCid:this.activeDraft.cid}},{type:"draft/uploadFileActiveDraft",payload:{file:e}}]:[{type:"draft/replaceActiveDraftUploadingFile",payload:{file:e}}];return void this.openAlert({title:this.__("An attachment already exists"),body:this.__("Are you sure you want to replace your current attachment?"),primaryActionText:this.__("Replace"),secondaryActionText:this.__("Cancel"),secondaryActions:[],primaryActions:t})}this.uploadFileActiveDraft({file:e})}else if(1===t.length){const n={file:t[0],left:e,top:i},o=!this.isAnyDraftActive;this.startNewDraft({attributes:n,shouldStartEditing:o}),o&&this.dockComposerModal()}else for(let o=0;o<t.length;++o){const n={attributes:{file:t[o],left:e+8*o,top:i+8*o}};this.createPost(n)}}handleLinkDrop({link:t,left:e,top:i,shouldAddToActiveDraft:n}){if(t)if(n){if(this.activeDraft.attachment||this.activeDraftUploadingFile)return void this.openAlert({title:this.__("An attachment already exists"),body:this.__("Are you sure you want to replace your current attachment?"),primaryActionText:this.__("Replace"),secondaryActionText:this.__("Cancel"),secondaryActions:[],primaryActions:[{type:"draft/replaceActiveDraftAttachmentWithLink",payload:{link:t}}]});this.updateActiveDraft({attachment:t,wish_content:{attachment_props:{url:t},is_processed:!1}})}else{const n={attachment:t,left:e,top:i},o=!this.isAnyDraftActive;this.startNewDraft({attributes:n,shouldStartEditing:o}),o&&this.dockComposerModal()}}handleTextDrop({text:t,left:e,top:i,shouldAddToActiveDraft:n}){if(!t)return;const o=t.replace(/\n/g,"<br/>");if(n)this.updateActiveDraft({body:(this.activeDraft.body||"")+"<br/>"+o});else{const t={body:o,left:e,top:i},n=!this.isAnyDraftActive;this.startNewDraft({attributes:t,shouldStartEditing:n}),n&&this.dockComposerModal()}}onDrop(t){this.isContentPickerOpened&&this.hideContentSourceMenu(),this.stopHandlingDragEvent();const e=t.dataTransfer;if(!e)return;const i=document.getElementById("wish-list"),n=Math.max(t.pageX-(i?i.getBoundingClientRect().left:0),0),o=Math.max(t.pageY-(i?i.getBoundingClientRect().top:0),0),a=this.isAnyComposerModalDocked&&this.postModalDropZone&&(t.clientX<this.postModalDropZone.left||t.clientX>this.postModalDropZone.right||t.clientY<this.postModalDropZone.top||t.clientY>this.postModalDropZone.bottom),r=this.isAnyDraftActive&&!a;this.draggedDataType===l.a.File?this.handleFileDrop({files:e.files,left:n,top:o,shouldAddToActiveDraft:r}):this.draggedDataType===l.a.Link?this.handleLinkDrop({link:e.getData("text/uri-list"),left:n,top:o,shouldAddToActiveDraft:r}):this.draggedDataType===l.a.Text&&this.handleTextDrop({text:e.getData("text/plain"),left:n,top:o,shouldAddToActiveDraft:r})}checkAndStartHandlingDragEvent(t){var e;const i=!!(null===(e=null===t||void 0===t?void 0:t.dataTransfer)||void 0===e?void 0:e.types)&&t.dataTransfer.types.includes("text/html")&&!t.dataTransfer.types.includes("text/plain");!t.dataTransfer||this.isMapHandlingDragEvent||i||this.isAPostDragging||this.startHandlingDragEvent()}onOverlayShown(t){t&&setTimeout(()=>{this.dropActionMessage||this.stopHandlingDragEvent()},500)}mounted(){o.a.addEventListener("dragenter",this.checkAndStartHandlingDragEvent)}beforeDestroy(){o.a.removeEventListener("dragenter",this.checkAndStartHandlingDragEvent)}};c([a.d,g("design:type",Boolean)],m.prototype,"isAPostDragging",void 0),c([h.Getter("isDocked"),g("design:type",Boolean)],m.prototype,"composerModalShouldDock",void 0),c([f.Getter("xContentSourceMenu"),g("design:type",Boolean)],m.prototype,"isContentPickerOpened",void 0),c([u.Getter,g("design:type",Boolean)],m.prototype,"isHandlingDragEvent",void 0),c([u.Getter,g("design:type",String)],m.prototype,"dropActionMessage",void 0),c([u.Getter,g("design:type","function"===typeof(n="undefined"!==typeof l.a&&l.a)?n:Object)],m.prototype,"draggedDataType",void 0),c([u.Getter,g("design:type",Object)],m.prototype,"postModalDropZone",void 0),c([D.Getter,g("design:type",Object)],m.prototype,"activeDraft",void 0),c([D.Getter,g("design:type",Object)],m.prototype,"activeDraftUploadingFile",void 0),c([D.Getter,g("design:type",Boolean)],m.prototype,"isAnyDraftActive",void 0),c([A.Getter("isDraggingLocationPickerPin"),g("design:type",Boolean)],m.prototype,"isDraggingLocationPickerPinInMap",void 0),c([A.Getter("isDraggingPosts"),g("design:type",Boolean)],m.prototype,"isDraggingPostsInMap",void 0),c([h.Action("dock"),g("design:type",Function)],m.prototype,"dockComposerModal",void 0),c([y.Action,g("design:type",Function)],m.prototype,"openAlert",void 0),c([y.Action,g("design:type",Function)],m.prototype,"resetAlert",void 0),c([f.Action,g("design:type",Function)],m.prototype,"hideContentSourceMenu",void 0),c([D.Action,g("design:type",Function)],m.prototype,"uploadFileActiveDraft",void 0),c([D.Action,g("design:type",Function)],m.prototype,"updateActiveDraft",void 0),c([D.Action,g("design:type",Function)],m.prototype,"startNewDraft",void 0),c([u.Action,g("design:type",Function)],m.prototype,"startHandlingDragEvent",void 0),c([u.Action,g("design:type",Function)],m.prototype,"stopHandlingDragEvent",void 0),c([u.Action,g("design:type",Function)],m.prototype,"setDraggedDataType",void 0),c([u.Action,g("design:type",Function)],m.prototype,"setDropActionMessage",void 0),c([v.Action,g("design:type",Function)],m.prototype,"createPost",void 0),c([Object(a.k)("isHandlingDragEvent"),g("design:type",Function),g("design:paramtypes",[Boolean]),g("design:returntype",void 0)],m.prototype,"onOverlayShown",null),m=c([Object(a.b)({})],m);var b=m,_=i(3),k=Object(_.a)(b,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.isHandlingDragEvent,expression:"isHandlingDragEvent"}],ref:"draggingOverlay",class:["fixed","inset-0","z-dragging-overlay",t.backgroundClasses],on:{dragenter:function(e){return e.preventDefault(),t.setupDragEvent.apply(null,arguments)},dragover:function(t){t.preventDefault()},dragleave:function(e){return e.preventDefault(),t.stopHandlingDragEvent.apply(null,arguments)},dragend:function(e){return e.preventDefault(),t.stopHandlingDragEvent.apply(null,arguments)},drop:function(e){return e.preventDefault(),t.onDrop.apply(null,arguments)}}},[t.isAnyDraftActive?t._e():e("div",{class:["w-[14.375rem]","h-[15.75rem]","absolute","pointer-events-none","inset-0","m-auto","bg-light-ui-100 dark:bg-dark-ui-100"],style:{maskImage:`url(${t.dragAndDropHexagonOutline})`,maskSize:"100% 100%"}},[e("div",{class:["w-[13.875rem]","h-[15.25rem]","absolute","inset-0","m-auto","flex","items-center","justify-center","bg-grape-500 dark:bg-canary-500"],style:{maskImage:`url(${t.dragAndDropHexagon})`,maskSize:"100% 100%"}},[e("div",{class:["w-[12rem]","text-input-body","font-sans","text-center","text-light-text-100 dark:text-dark-text-100","break-words"]},[t._v("\n        "+t._s(t.dropActionMessage)+"\n      ")])])])])}),[],!1,null,null,null);e.default=k.exports}}]);
//# sourceMappingURL=268-430f7d0ee629f4d056e5.chunk.js.map